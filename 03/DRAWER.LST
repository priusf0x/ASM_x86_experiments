Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 1
drawer.asm



      1	0000			     .model tiny
      2	0000			     .code
      3				     .286
      4				     org 100h
      5				     locals @@
      6
      7				     include macros.asm
1     8				     ; ======================= MACROS ==========================
1     9
1    10				     __exit__	 macro
1    11						     mov ah, 4ch
1    12						     int 21h
1    13						 endm
     14
     15				     ; ====================== ATRIBUTES	========================
     16
     17	      =0001		     FG_BLUE	     equ 00000001b
     18	      =0002		     FG_GREEN	     equ 00000010b
     19	      =0004		     FG_RED	     equ 00000100b
     20	      =0008		     FG_BRIGHT	     equ 00001000b
     21
     22	      =000F		     FG_WHITE	     equ FG_BLUE xor FG_GREEN xor FG_RED xor FG_BRIGHT
     23
     24	      =0010		     BG_BLUE	     equ 00010000b
     25	      =0020		     BG_GREEN	     equ 00100000b
     26	      =0040		     BG_RED	     equ 01000000b
     27	      =0080		     BG_BLINK	     equ 10000000b
     28
     29	      =0070		     BG_WHITE	     equ BG_BLUE xor BG_GREEN xor BG_RED
     30
     31				     ; ======================= HELPERS =========================
     32
     33	      =B800		     VRAM_LOCATION   equ 0B800h
     34	      =0028		     CENTER_X	     equ 40
     35	      =000D		     CENTER_Y	     equ 13
     36	      =0023		     SEPARATOR	     equ '#'
     37	      =00A0		     NEW_LINE_OFFSET equ 160
     38	      =0081		     BUFFER	     equ 81h
     39	      =0080		     BUFFER_LENGTH   equ 80h
     40
     41	*100			     rect_style	     struc
     42	*000  01*(??)					     global_filling    db ?
     43	*001  01*(??)					     global_style      db ?
     44	*002  01*(??)					     global_atribute   db ?
     45	*003					     ends
     46
     47	*100			     rect_filling    struc
     48	*000  01*(??)					     filling_ul	db ?
     49	*001  01*(??)					     filling_u	db ?
     50	*002  01*(??)					     filling_ur	db ?
     51	*003  01*(??)					     filling_ml	db ?
     52	*004  01*(??)					     filling_m	db ?
     53	*005  01*(??)					     filling_mr	db ?
     54	*006  01*(??)					     filling_dl	db ?
     55	*007  01*(??)					     filling_d	db ?
     56	*008  01*(??)					     filling_dr	db ?
     57	*009					     ends
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 2
drawer.asm



     58
     59				     ; =========================================================
     60
     61	0100			     __start__:
     62
     63	0100  E8 0004				     call main
     64
     65						     __exit__
1    66	0103  B4 4C				     mov ah, 4ch
1    67	0105  CD 21				     int 21h
     68
     69	0107			     .data
     70	0000  70 40 70		     FRAME_STYLE     rect_style	<BG_WHITE, BG_RED, BG_WHITE>
     71	0003  06 05 06 05 20 05	06+  FRAME_FILLING   rect_filling <6,5,6,5,32,5,6,5,6>
     72	      05 06
     73	000C			     STYLES:
     74	000C  70 40 70		     DREC_CLASSIC    rect_style	<BG_WHITE, BG_RED, BG_WHITE>
     75	000F  10 70 10		     OLD_SCHOOL	     rect_style	<BG_BLUE, BG_WHITE, BG_BLUE>
     76	0012  00 70 00		     GITHUB	     rect_style	<      0, BG_WHITE, 0>
     77	0015			     FILLINGS:
     78	0015  06 05 06 06 20 06	06+  DREC_FILLING    rect_filling <06, 05h, 06h	, 06h, 20h,\
     79	      05 06						   06h,	06h, 05h, 06h>
     80	001E  2F 2D 5C 7C 20 7C	5C+  CLASSIC_FILLING rect_filling <"/",	"-", "\", "|", 20h,\
     81	      2D 2F						   "|",	"\", "-", "/">
     82	0027  0B 0C 0B 0C 20 0C	0B+  NAXUI_FPMI	     rect_filling <0bh,	0ch, 0bh, 0ch, 20h,\
     83	      0C 0B						   0ch,	0bh, 0ch, 0bh>
     84
     85				     ; ======================= FUNCTIONS ========================
     86
     87	0030			     .code
     88
     89				     ; ========================= MAIN ==========================
     90
     91	0107			     main:
     92
     93	0107  8A 0E 0080			     mov cl, ds:[BUFFER_LENGTH]
     94	010B  BE 0081				     mov si, BUFFER
     95	010E  E8 0050				     call set_style
     96	0111  E8 0017				     call set_filling
     97
     98	0114  56				     push si
     99	0115  51				     push cx
    100
    101	0116  8B FE				     mov di, si
    102
    103	0118  E8 0163				     call get_size
    104
    105	011B  51				     push cx
    106	011C  E8 019B				     call calculate_left_up_corner
    107	011F  59				     pop cx
    108
    109	0120  53				     push bx
    110	0121  E8 00E4				     call draw_frame
    111
    112	0124  5F				     pop di
    113	0125  59				     pop cx
    114	0126  5E				     pop si
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 3
drawer.asm



    115	0127  E8 009C				     call write_text_centered
    116
    117	012A  C3				     ret
    118
    119				     ; ==================== STRING FUNCTION ====================
    120
    121				     ; _________________________________________________________
    122				     ; Setting frame filling
    123				     ;
    124				     ; args:
    125				     ;	     es:di - input string
    126				     ;
    127				     ; delete:
    128				     ;	     al
    129				     ; _________________________________________________________
    130
    131	012B			     set_filling:
    132
    133	012B  8B FE				     mov di, si
    134	012D  E8 0055				     call skip_spaces
    135	0130  8B FE				     mov di, si
    136
    137	0132  AC				     lodsb
    138	0133  49				     dec cx
    139	0134  2D 0030				     sub ax, "0"
    140
    141	0137  74 1A				     jz	@@parse_fillings
    142
    143	0139  48				     dec ax
    144	013A  8B D8				     mov bx, ax
    145	013C  C1 E3 03				     shl bx, 3
    146	013F  03 D8				     add bx, ax		; multiplication on 8
    147
    148	0141  56				     push si
    149	0142  51				     push cx
    150
    151	0143  BE 0015r				     mov si, offset FILLINGS
    152	0146  03 F3				     add si, bx
    153
    154	0148  B9 0009				     mov cx, 09h
    155
    156	014B  BF 0003r				     mov di, offset FRAME_FILLING
    157
    158	014E  F3> A4				     rep movsb
    159
    160	0150  59				     pop cx
    161	0151  5E				     pop si
    162
    163	0152  C3				     ret
    164
    165	0153			     @@parse_fillings:
    166	0153  51				     push cx
    167	0154  B9 0009				     mov cx, 09h
    168	0157  BF 0003r				     mov di, offset FRAME_FILLING
    169	015A  F3> A4				     rep movsb
    170	015C  59				     pop cx
    171	015D  83 E9 09				     sub cx, 09h
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 4
drawer.asm



    172
    173	0160  C3				     ret
    174
    175				     ; _________________________________________________________
    176
    177				     ; _________________________________________________________
    178				     ; Setting frame style
    179				     ;
    180				     ; args:
    181				     ;	     ds:si - input string
    182				     ;	     cx	   - string length
    183				     ;
    184				     ; returns:
    185				     ;	     ds:si - ptr to skipped arg
    186				     ;	     cx	   - length es:di
    187				     ; delete:
    188				     ;	     ax, bx, si, es
    189				     ; _________________________________________________________
    190
    191	0161			     set_style:
    192
    193	0161  8B FE				     mov di, si
    194	0163  E8 001F				     call skip_spaces
    195	0166  8B F7				     mov si, di
    196
    197	0168  AC				     lodsb
    198	0169  49				     dec cx
    199	016A  2D 0030				     sub ax, "0"
    200
    201	016D  8B D8				     mov bx, ax
    202	016F  D1 E3				     shl bx, 1
    203	0171  03 D8				     add bx, ax
    204
    205	0173  56				     push si
    206	0174  51				     push cx
    207										  ; preparing for copiing
    208
    209	0175  BE 000Cr				     mov si, offset STYLES
    210	0178  03 F3				     add si, bx
    211
    212	017A  B9 0003				     mov cx, 03h
    213
    214	017D  BF 0000r				     mov di, offset FRAME_STYLE
    215
    216	0180  F3> A4				     rep movsb
    217
    218	0182  59				     pop cx
    219	0183  5E				     pop si
    220
    221	0184  C3				     ret
    222
    223				     ; _________________________________________________________
    224
    225				     ; _________________________________________________________
    226				     ; Skip Spaces until not space symbol
    227				     ;
    228				     ; args:
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 5
drawer.asm



    229				     ;	     es:di - input string
    230				     ;	     cx	   - string length
    231				     ;
    232				     ; return:
    233				     ;	     di	- skipped until	separator
    234				     ;	     ci	- si string length
    235				     ; delete:
    236				     ;	     al
    237				     ; _________________________________________________________
    238
    239	0185			     skip_spaces:
    240
    241	0185  FC				     cld
    242	0186  B0 20				     mov al, 20h
    243
    244	0188  F3> AE				     repe scasb
    245	018A  41				     inc cx
    246	018B  4F				     dec di
    247
    248	018C  C3				     ret
    249
    250				     ; _________________________________________________________
    251
    252				     ; _________________________________________________________
    253				     ; Returns length of rhe ds:si string with separator
    254				     ;	     symbol
    255				     ; args:
    256				     ;	     es:di - input string
    257				     ;	     cx	   - string length
    258				     ; return:
    259				     ;	     bx	- string length
    260				     ;	     di	- skipped until	separator or EOL
    261				     ;	     cx	- length of new	si string
    262				     ; delete
    263				     ;	     ax
    264				     ; _________________________________________________________
    265
    266	018D			     strlen:
    267
    268	018D  8B D9				     mov bx, cx
    269	018F  85 C9				     test cx, cx
    270	0191  74 0B				     jz	@@skip
    271
    272	0193  33 C0				     xor ax, ax
    273
    274	0195  FC				     cld
    275
    276	0196  B0 23				     mov al, separator
    277	0198  F2> AE				     repne scasb
    278
    279	019A  75 02				     jne @@skip
    280	019C  41				     inc cx
    281	019D  4F				     dec di
    282
    283	019E			     @@skip:
    284	019E  2B D9				     sub bx, cx
    285	01A0			     @@leave:
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 6
drawer.asm



    286	01A0  C3				     ret
    287
    288				     ; _________________________________________________________
    289
    290				     ; _________________________________________________________
    291				     ; Count amount of al(ASCII) symbols in string es:al
    292				     ;
    293				     ; args:
    294				     ;	     al	   - symbol
    295				     ;	     es:di - input string
    296				     ;	     cx	   - string length
    297				     ;
    298				     ; return:
    299				     ;	     dx	- symbol amount
    300				     ;
    301				     ; delete
    302				     ;	     cx, si
    303				     ; _________________________________________________________
    304
    305	01A1			     count_al_symbols_in_string:
    306
    307	01A1  33 D2				     xor dx, dx
    308	01A3  FC				     cld
    309
    310	01A4			     @@continue:
    311
    312	01A4  F2> AE				     repne scasb
    313	01A6  74 01				     je	@@increment
    314
    315	01A8  C3				     ret
    316
    317	01A9			     @@increment:
    318	01A9  42				     inc dx
    319	01AA  EB F8				     jmp @@continue
    320
    321				     ; _________________________________________________________
    322
    323				     ; _________________________________________________________
    324				     ; Write ds:si line	with ah:al indent with offset es:si
    325				     ;
    326				     ; args:
    327				     ;	     cx	   - printable string length
    328				     ;	     es:di - offset
    329				     ;	     ds:si - source
    330				     ; returns:
    331				     ;	     si	- the next symbol after	last written
    332				     ;
    333				     ; delete:
    334				     ;	     di, cx
    335				     ; _________________________________________________________
    336
    337	01AC			     write_line:
    338
    339	01AC  85 C9				     test cx, cx
    340	01AE  74 09				     jz	@@leave
    341
    342	01B0  FC				     cld
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 7
drawer.asm



    343	01B1  8A 26 0002r			     mov ah, FRAME_STYLE.global_atribute
    344
    345	01B5  AC		     @@scope:	     lodsb
    346	01B6  AB				     stosw
    347	01B7  E2 FC				     loop @@scope
    348	01B9			     @@leave:
    349
    350	01B9  C3				     ret
    351
    352				     ; _________________________________________________________
    353				     ; Write string with centering
    354				     ;
    355				     ; args:
    356				     ;	     cx	   - string length
    357				     ;	     es:di - start_line	offset
    358				     ;	     ds:si - source
    359				     ;
    360				     ; delete:
    361				     ;	     di, cx, bx, si
    362				     ; _________________________________________________________
    363
    364	01BA			     write_string_centered:
    365
    366	01BA  83 C7 50				     add di, CENTER_X *	2
    367	01BD  2B F9				     sub di, cx
    368
    369	01BF  83 E7 FE				     and di, 0FFFFh - 1
    370
    371	01C2  E8 FFE7				     call write_line
    372
    373	01C5  C3				     ret
    374				     ; _________________________________________________________
    375
    376				     ; _________________________________________________________
    377				     ; Write text with centering
    378				     ;
    379				     ; args:
    380				     ;	     cx	   - string length
    381				     ;	     es:di - start_line	offset
    382				     ;	     ds:si - source
    383				     ;
    384				     ; delete:
    385				     ;	     ax, bx, cx, dx, di, si
    386				     ; _________________________________________________________
    387
    388	01C6			     write_text_centered:
    389
    390	01C6			     @@scope:
    391
    392	01C6  51				     push cx
    393	01C7  57				     push di
    394	01C8  06				     push es
    395
    396	01C9  8C D8				     mov ax, ds
    397	01CB  8E C0				     mov es, ax
    398	01CD  8B FE				     mov di, si
    399
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 8
drawer.asm



    400	01CF  E8 FFBB				     call strlen
    401
    402	01D2  07				     pop es
    403	01D3  5F				     pop di
    404	01D4  59				     pop cx
    405
    406	01D5  2B CB				     sub cx, bx
    407
    408	01D7  51				     push cx
    409	01D8  57				     push di
    410
    411	01D9  8B CB				     mov cx, bx
    412	01DB  E8 FFDC				     call write_string_centered
    413
    414	01DE  5F				     pop di
    415	01DF  59				     pop cx
    416
    417	01E0  81 C7 00A0			     add di, NEW_LINE_OFFSET
    418
    419	01E4  85 C9				     test cx, cx
    420	01E6  75 01				     jnz @@decrease
    421
    422	01E8  C3				     ret
    423
    424	01E9			     @@decrease:
    425	01E9  46				     inc si
    426	01EA  49				     dec cx
    427	01EB  EB D9				     jmp @@scope
    428
    429				     ; _________________________________________________________
    430
    431				     ; ==================== DRAW_FUNCTION ======================
    432
    433				     ; _________________________________________________________
    434				     ; Draws horizontal	line with length of cx on es:di	offset
    435				     ;
    436				     ; args:
    437				     ;	     ah	   - atribute
    438				     ;	     al	   - ASCII character
    439				     ;	     cx	   - string length
    440				     ;	     es:di - start point offset
    441				     ;
    442				     ; returns:
    443				     ;	     di	- new cursor position
    444				     ;
    445				     ; delete:
    446				     ;	     cx
    447				     ; _________________________________________________________
    448
    449	01ED			     draw_horizontal:
    450
    451	01ED  F3> AB				     rep stosw
    452
    453	01EF  C3				     ret
    454
    455				     ; _________________________________________________________
    456				     ; Draws horizontal	line() with length of cx on es:di offset
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 9
drawer.asm



    457				     ;
    458				     ; args:
    459				     ;1st symbol:    ah	   - atribute
    460				     ;		     al	   - ASCII character
    461				     ;2st symbol:    bh	   - atribute
    462				     ;		     bl	   - ASCII character
    463				     ;3st symbol:    dh	   - atribute
    464				     ;		     dl	   - ASCII character
    465				     ;
    466				     ;		     cx	   - string length
    467				     ;		     es:di - start point offset
    468				     ;
    469				     ; delete:
    470				     ;	     di
    471				     ; _________________________________________________________
    472
    473	01F0			     draw_frame_line:
    474
    475	01F0  50				     push ax
    476	01F1  51				     push cx
    477	01F2  B9 0001				     mov cx, 1
    478	01F5  E8 FFF5				     call draw_horizontal
    479
    480	01F8  59				     pop cx
    481	01F9  8B C3				     mov ax, bx
    482	01FB  E8 FFEF				     call draw_horizontal
    483
    484	01FE  B9 0001				     mov cx, 1
    485	0201  8B C2				     mov ax, dx
    486	0203  E8 FFE7				     call draw_horizontal
    487
    488	0206  58				     pop ax
    489
    490	0207  C3				     ret
    491				     ; _________________________________________________________
    492
    493				     ; _________________________________________________________
    494				     ; Draws a frame
    495				     ;
    496				     ; args:
    497				     ;		     ch	- height
    498				     ;		     cl	- length
    499				     ;		     es:di - start point offset
    500				     ;
    501				     ; delete:
    502				     ;	     ax, bx, cx, dx, di, si
    503				     ; _________________________________________________________
    504
    505	0208			     draw_frame:
    506
    507				     ;;;;;;;;;;;;;;;;;;;;;;;; saving cx	;;;;;;;;;;;;;;;;;;;;;;;;
    508
    509	0208  8B F1				     mov si, cx
    510
    511				     ;;;;;;;;;;;;;;;;;;; drawing upper part ;;;;;;;;;;;;;;;;;;;;
    512
    513	020A  8A 26 0001r			     mov ah, FRAME_STYLE.global_style
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 10
drawer.asm



    514	020E  8A 3E 0001r			     mov bh, FRAME_STYLE.global_style
    515	0212  8A 36 0001r			     mov dh, FRAME_STYLE.global_style
    516
    517	0216  A0 0003r				     mov al, FRAME_FILLING.filling_ul
    518	0219  8A 1E 0004r			     mov bl, FRAME_FILLING.filling_u
    519	021D  8A 16 0005r			     mov dl, FRAME_FILLING.filling_ur
    520
    521	0221  57				     push di
    522
    523	0222  32 ED				     xor ch, ch
    524	0224  E8 FFC9				     call draw_frame_line
    525
    526	0227  5F				     pop di
    527	0228  81 C7 00A0			     add di, NEW_LINE_OFFSET
    528
    529				     ;;;;;;;;;;;;;;;;;;; drawing middle	part ;;;;;;;;;;;;;;;;;;;;
    530
    531	022C  8B CE				     mov cx, si
    532
    533	022E  8A 26 0001r			     mov ah, FRAME_STYLE.global_style
    534	0232  8A 3E 0000r			     mov bh, FRAME_STYLE.global_filling
    535	0236  8A 36 0001r			     mov dh, FRAME_STYLE.global_style
    536
    537	023A  A0 0006r				     mov al, FRAME_FILLING.filling_ml
    538	023D  8A 1E 0007r			     mov bl, FRAME_FILLING.filling_m
    539	0241  8A 16 0008r			     mov dl, FRAME_FILLING.filling_mr
    540
    541	0245  EB 2F 90				     jmp @@test
    542	0248			     @@scope:
    543
    544	0248  FE CD				     dec ch
    545	024A  8B F1				     mov si, cx
    546
    547	024C  32 ED				     xor ch, ch
    548	024E  57				     push di
    549	024F  E8 FF9E				     call draw_frame_line
    550	0252  5F				     pop di
    551	0253  81 C7 00A0			     add di, NEW_LINE_OFFSET
    552
    553	0257  75 1D				     jnz @@test
    554
    555	0259			     @@skip:
    556
    557				     ;;;;;;;;;;;;;;;;;;	drawing	lower part ;;;;;;;;;;;;;;;;;;;;;
    558
    559	0259  8A 26 0001r			     mov ah, FRAME_STYLE.global_style
    560	025D  8A 3E 0001r			     mov bh, FRAME_STYLE.global_style
    561	0261  8A 36 0001r			     mov dh, FRAME_STYLE.global_style
    562
    563	0265  A0 0009r				     mov al, FRAME_FILLING.filling_dl
    564	0268  8A 1E 000Ar			     mov bl, FRAME_FILLING.filling_d
    565	026C  8A 16 000Br			     mov dl, FRAME_FILLING.filling_dr
    566
    567	0270  8B CE				     mov cx, si
    568
    569	0272  E8 FF7B				     call draw_frame_line
    570
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 11
drawer.asm



    571	0275  C3				     ret
    572
    573	0276			     @@test:
    574	0276  8B CE				     mov cx, si
    575	0278  84 ED				     test ch, ch
    576	027A  75 CC				     jnz @@scope
    577	027C  EB DB				     jmp @@skip
    578
    579				     ; _________________________________________________________
    580
    581				     ; _________________________________________________________
    582				     ; Get frame optimal size considered to string content
    583				     ;
    584				     ; args:
    585				     ;	     cx	   - string length
    586				     ;	     es:di - text
    587				     ;
    588				     ; returns:
    589				     ;	     ch	- frame	height
    590				     ;	     cl	- frame	length
    591				     ;
    592				     ; delete:
    593				     ;	     ?all?
    594				     ; _________________________________________________________
    595
    596	027E			     get_size:
    597
    598	027E  51				     push cx
    599	027F  57				     push di
    600
    601	0280  B0 23				     mov al, SEPARATOR
    602	0282  E8 FF1C				     call count_al_symbols_in_string
    603	0285  8B CA				     mov cx, dx
    604	0287  41				     inc cx
    605	0288  C1 E1 08				     shl cx, 8
    606
    607	028B  5F				     pop di
    608	028C  58				     pop ax
    609	028D  51				     push cx
    610
    611	028E  8B C8				     mov cx, ax
    612
    613	0290			     @@scope:
    614
    615	0290  51				     push cx
    616	0291  E8 FEF9				     call strlen
    617	0294  59				     pop cx
    618
    619	0295  2B CB				     sub cx, bx
    620
    621	0297  3B DA				     cmp bx, dx
    622	0299  77 0E				     ja	@@new_lenght
    623	029B			     @@continue:
    624
    625	029B  85 C9				     test cx, cx
    626	029D  75 06				     jnz @@decrease
    627
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 12
drawer.asm



    628	029F  59				     pop cx
    629	02A0  8A CA				     mov cl, dl
    630	02A2  FE C1				     inc cl
    631
    632	02A4  C3				     ret
    633
    634	02A5			     @@decrease:
    635	02A5  47				     inc di
    636	02A6  49				     dec cx
    637	02A7  EB E7				     jmp @@scope
    638
    639	02A9			     @@new_lenght:
    640	02A9  8B D3				     mov dx, bx
    641	02AB  EB EE				     jmp @@continue
    642
    643				     ; _________________________________________________________
    644
    645				     ; _________________________________________________________
    646				     ; Translates bx into string offset
    647				     ;
    648				     ; args:
    649				     ;	     di	- string number
    650				     ;
    651				     ; return:
    652				     ;	     di	- new offset
    653				     ; del
    654				     ;	     bx
    655				     ; _________________________________________________________
    656
    657	02AD			     translate_string:
    658
    659	02AD  8B DF				     mov bx, di
    660	02AF  C1 E7 03				     shl di, 3
    661	02B2  D1 E3				     shl bx, 1
    662	02B4  03 FB				     add di, bx
    663	02B6  C1 E7 04				     shl di, 4
    664
    665	02B9  C3				     ret
    666
    667				     ; _________________________________________________________
    668
    669				     ; _________________________________________________________
    670				     ; Count left corner coordinate
    671				     ;
    672				     ; args:
    673				     ;	     ch	- frame	height
    674				     ;	     cl	- frame	length
    675				     ;
    676				     ; returns:
    677				     ;	     es	- vram sector
    678				     ;	     di	- left corner offset
    679				     ;	     bx	- start	string
    680				     ;
    681				     ; _________________________________________________________
    682
    683	02BA			     calculate_left_up_corner:
    684
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 13
drawer.asm



    685	02BA  BB B800				     mov bx, VRAM_LOCATION
    686	02BD  8E C3				     mov es, bx
    687
    688	02BF  D0 ED				     shr ch, 1
    689	02C1  D0 E9				     shr cl, 1
    690	02C3  81 C1 0101			     add cx, 0101h
    691
    692	02C7  BB 000D				     mov bx, CENTER_Y
    693	02CA  2A DD				     sub bl, ch
    694	02CC  8B FB				     mov di, bx
    695
    696	02CE  E8 FFDC				     call translate_string
    697	02D1  8B DF				     mov bx, di
    698	02D3  81 C3 00A0			     add bx, NEW_LINE_OFFSET
    699	02D7  53				     push bx
    700
    701	02D8  BB 0028				     mov bx, CENTER_X
    702	02DB  2A D9				     sub bl, cl
    703	02DD  D1 E3				     shl bx, 1
    704
    705	02DF  03 FB				     add di, bx
    706
    707	02E1  5B				     pop bx
    708
    709	02E2  C3				     ret
    710
    711				     ; _________________________________________________________
    712
    713				     end __start__
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 14
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/15/26"
??FILENAME			  Text	 "drawer  "
??TIME				  Text	 "12:40:49"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@CONTINUE			  Near	 DGROUP:01A4
@@CONTINUE			  Near	 DGROUP:029B
@@DECREASE			  Near	 DGROUP:01E9
@@DECREASE			  Near	 DGROUP:02A5
@@INCREMENT			  Near	 DGROUP:01A9
@@LEAVE				  Near	 DGROUP:01A0
@@LEAVE				  Near	 DGROUP:01B9
@@NEW_LENGHT			  Near	 DGROUP:02A9
@@PARSE_FILLINGS		  Near	 DGROUP:0153
@@SCOPE				  Near	 DGROUP:01B5
@@SCOPE				  Near	 DGROUP:01C6
@@SCOPE				  Near	 DGROUP:0248
@@SCOPE				  Near	 DGROUP:0290
@@SKIP				  Near	 DGROUP:019E
@@SKIP				  Near	 DGROUP:0259
@@TEST				  Near	 DGROUP:0276
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0707H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 DRAWER
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BG_BLINK			  Number 0080
BG_BLUE				  Number 0010
BG_GREEN			  Number 0020
BG_RED				  Number 0040
BG_WHITE			  Number 0070
BUFFER				  Number 0081
BUFFER_LENGTH			  Number 0080
CALCULATE_LEFT_UP_CORNER	  Near	 DGROUP:02BA
CENTER_X			  Number 0028
CENTER_Y			  Number 000D
CLASSIC_FILLING			  Struct DGROUP:001E RECT_FILLING
COUNT_AL_SYMBOLS_IN_STRING	  Near	 DGROUP:01A1
DRAW_FRAME			  Near	 DGROUP:0208
DRAW_FRAME_LINE			  Near	 DGROUP:01F0
DRAW_HORIZONTAL			  Near	 DGROUP:01ED
DREC_CLASSIC			  Struct DGROUP:000C RECT_STYLE
DREC_FILLING			  Struct DGROUP:0015 RECT_FILLING
FG_BLUE				  Number 0001
FG_BRIGHT			  Number 0008
FG_GREEN			  Number 0002
FG_RED				  Number 0004
FG_WHITE			  Number 000F
Turbo Assembler	 Version 4.1	    02/15/26 12:40:49	    Page 15
Symbol Table



FILLINGS			  Near	 DGROUP:0015
FRAME_FILLING			  Struct DGROUP:0003 RECT_FILLING
FRAME_STYLE			  Struct DGROUP:0000 RECT_STYLE
GET_SIZE			  Near	 DGROUP:027E
GITHUB				  Struct DGROUP:0012 RECT_STYLE
MAIN				  Near	 DGROUP:0107
NAXUI_FPMI			  Struct DGROUP:0027 RECT_FILLING
NEW_LINE_OFFSET			  Number 00A0
OLD_SCHOOL			  Struct DGROUP:000F RECT_STYLE
SEPARATOR			  Number 0023
SET_FILLING			  Near	 DGROUP:012B
SET_STYLE			  Near	 DGROUP:0161
SKIP_SPACES			  Near	 DGROUP:0185
STRLEN				  Near	 DGROUP:018D
STYLES				  Near	 DGROUP:000C
TRANSLATE_STRING		  Near	 DGROUP:02AD
VRAM_LOCATION			  Number B800
WRITE_LINE			  Near	 DGROUP:01AC
WRITE_STRING_CENTERED		  Near	 DGROUP:01BA
WRITE_TEXT_CENTERED		  Near	 DGROUP:01C6
__START__			  Near	 DGROUP:0100

Macro Name

__EXIT__

Structure Name			  Type	Offset

RECT_FILLING
 FILLING_UL			  Byte	 0000
 FILLING_U			  Byte	 0001
 FILLING_UR			  Byte	 0002
 FILLING_ML			  Byte	 0003
 FILLING_M			  Byte	 0004
 FILLING_MR			  Byte	 0005
 FILLING_DL			  Byte	 0006
 FILLING_D			  Byte	 0007
 FILLING_DR			  Byte	 0008
RECT_STYLE
 GLOBAL_FILLING			  Byte	 0000
 GLOBAL_STYLE			  Byte	 0001
 GLOBAL_ATRIBUTE		  Byte	 0002

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0030 Word	  Public  DATA
  _TEXT				  16  02E3 Word	  Public  CODE
